#include "sys_config.h"
#include "typesdef.h"
#include "lib/video/dvp/cmos_sensor/csi.h"
#include "tx_platform.h"
#include "list.h"
#include "dev.h"
#include "hal/isp.h"

/* lens & sensor config information:
- sensor      : sensor_name
- fstop       : TBD
- mclk        : TBD
- max FPS     : TBD
- frame length: TBD
- usage       : TBD
- interface   : TBD
*/

#if DEV_SENSOR_NAME
#define SLAVE_MODE      0

SENSOR_INIT_SECTION const unsigned char nameInitTable[CMOS_INIT_LEN]=
{
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,  //0x32, 0x19
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
//  0x000d, 0x41, 0x02, // frame length[15:8]
//  0x000d, 0x42, 0xee, // frame length[07:0]
    0x00, 0x00, 0x00, // frame length[15:8]
    0x00, 0x00, 0x00, // frame length[07:0]
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, //[1 : 0]     00 : normal             01 : vertical fip
    0x00, 0x00, 0x00, //            10:horizonral mirror    11 : horizonral & vertical
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, //[1:0],0x1:no data gate clk
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,    

    //dpc //
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,  //【5】bit=0  dpc enable  on
    0x00, 0x00, 0x00,  //【7】bit=0 auto //【7】bit=1 manual
    0x00, 0x00, 0x00,  //[7:0]越小越强
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,  //[3:0]越大越强
    0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,     
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,  
    0x00, 0x00, 0x00,  //[7:0]越大越强
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
    0x00, 0x00, 0x00,
	
    0xff, 0xff, 0xff,
};

const _Sensor_CCM name_ccm_init = {
// 4000K, gamma2.2
    0,    0,    0,
    0,    0,    0,
    0,    0,    0,
    0,    0,    0,
};

const _Sensor_BLC name_blc_init =
{
    0,  0,  0,  0,
};

const _Sensor_AWB name_awb_init = 
{
    .default_gain   = {000,000,000,000},
    .awb_min_gain   = {000,000,000,000},
    .awb_max_gain   = {000,000,000,000},
 
    .coarse_constraint = {
        .coarse_min_bg = 0,
        .coarse_lb_bg  = 0,
        .coarse_rt_bg  = 0,
        .coarse_max_bg = 0,
        .coarse_min_rg = 0,
        .coarse_lb_rg  = 0,
        .coarse_rt_rg  = 0,
        .coarse_max_rg = 0,   
    },

    .constraint = {
        .section_num = 5,      
        .color_temp = { 0, 0, 0, 0, 0, 0, 0, 0},
        .sec_line_slope = { 0, 0, 0, 0, 0, 0, 0, 0},
        .sec_line_offset = { 0, 0, 0, 0, 0, 0, 0, 0},
        .sec_line_sqrtk2add1 = { 0, 0, 0, 0, 0, 0, 0, 0},
        .center_line_slope = { 0, 0, 0, 0, 0, 0, 0, 0},
        .center_line_offset = { 0, 0, 0, 0, 0, 0, 0, 0},
        .lower_line_slope = { 0, 0, 0, 0, 0, 0, 0, 0},
        .lower_line_offset ={ 0, 0, 0, 0, 0, 0, 0, 0},
        .upper_line_slope = { 0, 0, 0, 0, 0, 0, 0, 0},
        .upper_line_offset ={ 0, 0, 0, 0, 0, 0, 0, 0},
        .corner_limit = { 0, 0, 0, 0, 0, 0, 0, 0},
    },
};

const _Sensor_AE name_ae_init = 
{
    .max_frame_length      = 0,
    .min_frame_vb          = 0,
    .max_analog_gain       = 0,
    .min_analog_gain       = 0,
    .default_exposure_line = 0, //0x2e9,//0x2de,
    .max_exposure_line     = 0, //749,
    .min_exposure_line     = 0,
    .row_time_us           = 0,//89,
    .expo_frame_interval   = 0,
    .to_day_bv             = 0,
    .to_night_bv           = 0,
    .dark_scene_target_lut = {0, 0},
    .dark_scene_bv_lut     = {0, 0},
    .hs_scene_limit_lut    = {0, 0},
    .hs_scene_bv_lut       = {0, 0},
    .lowlight_lsb_bv_lut   = { 0, 0, 0, 0, 0, 0, 0, 0},
    .lowlight_lsb_gain_lut = { 0, 0, 0, 0, 0, 0, 0, 0}, // u7.4
};

const _Sensor_DPC name_dpc_init = 
{
    .static_psram_addr      = (uint32)0,
    .white_threshold        = 115,
    .black_threshold        = 115,
    .white_threshold_min    = 30,
    .black_threshold_min    = 30,
    .sensitivity_value      = 128,
    .dynamic_white_strength = 4,
    .dynamic_black_strength = 4,
};

const _Sensor_CSC name_csc_init = 
{
    .rgb2yuv_gamut         = ISP_YUV_GAMUT_BT709,
    .rgb2yuv_range         = ISP_YUV_RANGE_NARROW,
    .yuv2rgb_in_gamut      = ISP_YUV_GAMUT_BT709,
    .yuv2rgb_in_range      = ISP_YUV_RANGE_NARROW,
    .yuv2rgb_out_gamut     = ISP_YUV_GAMUT_BT709,
    .yuv2rgb_out_range     = ISP_YUV_RANGE_NARROW,
    .y_gamma_alpha         = 0xff,
    .rgb_gamma_alpha       = 0xff,
};

const _Sensor_GIC name_gic_init = 
{
    .w_thres  = 14,
    .w_slope  = 16,
    .w_str    = 127,
    .mu_thres = 5,
    .mu_slope = 16,
};

const _Sensor_CSUPP name_csupp_init = {
// uint8  U_luma_thr_lo, U_luma_slop_lo, U_luma_shfb_lo, U_luma_gmin_lo,
// uint8  U_luma_thr_hi, U_luma_slop_hi, U_luma_shfb_hi, U_luma_gmin_hi,
// uint8  V_luma_thr_lo, V_luma_slop_lo, V_luma_shfb_lo, V_luma_gmin_lo,
// uint8  V_luma_thr_hi, V_luma_slop_hi, V_luma_shfb_hi, V_luma_gmin_hi,
// uint8  chroma_thr_lo, chroma_slop_lo, chroma_shfb_lo, chroma_gmin_lo,
    0,   0,   0,   0,
    0,   0,   0,   0,
    0,   0,   0,   0,
    0,   0,   0,   0,
    0,   0,   0,   0,
};

const _Sensor_SHARP name_sharp_init = {
    .filt_alpha      = 0,
    .shrink_thr      = 0,
    .filt_clip_hi    = 0,
    .filt_clip_lo    = 0,
    .sp_thr2 		 = 0,
    .sp_thr1 	 	 = 0,
    .enha_clip_hi 	 = 0,
    .enha_clip_lo	 = 0, 
    
    .e1 = 0, .e2 = 0, .e3 = 0,
    .k0 = 0, .k1 = 0, .k2 = 0, .k3 = 0,
    .y1 = 0,              // y1 = k0*e1
    .y2 = 0,              // y2 = k1*e2 + (y1 - k1*e1) = k1 * (e2 - e1) + y1
    .y3 = 0,              // y3 = k2*e3 + (y2 - k2*e2) = k2 * (e3 - e2) + y2

    .filt_w11 = 0,  .filt_w12 = 0,  .filt_w13 = 0,
    .filt_w21 = 0,  .filt_w22 = 0,  .filt_w23 = 0,
    .filt_w31 = 0,  .filt_w32 = 0,  .filt_w33 = 0,
    .filt_type       = 0,
    .filt_sbit       = 0,
    .lpf_scale		 = 0,

    .strength_lut    = {0, 0},
    .strength_bv_lut = {0, 0},
};

const _Sensor_YUVNR name_yuvnr_init = {
	.y_thr_tal0 = 0,
	.y_thr_tal1 = 0,
	.y_thr_tal2 = 0,
	.y_thr_tal3 = 0,
	.y_thr_tal4 = 0,
	.y_thr_tal5 = 0,
	.y_thr_tal6 = 0,
	.y_thr_tal7 = 0,
	.y_alfa     = 0,
	.c_alfa     = 0,
	.y_win_size = 0,
};

const _Sensor_COLENH name_colenh_init = {
    .yuv_range      = 0,
    .luma           = 0,
    .contrast       = 0,
    .saturation     = 0,
    .hue            = 0,
    .ce_in_ofs_y    = 0,
    .ce_in_ofs_cb   = 0,
    .ce_in_ofs_cr   = 0,
    .ce_out_ofs_y   = 0,
    .ce_out_ofs_cb  = 0,
    .ce_out_ofs_cr  = 0,
    .adj_sat_by_bv  = 0,
    .hi_sat         = 0,
    .lo_sat         = 0,
    .hi_sat_bv      = 0,
    .lo_sat_bv      = 0,
};

const _Sensor_BV2NR name_bv2nr_init[BV2RAWNR_ARRAY_NUM] = {
    //           bv, bnr_range_weight_index, bnr_invksigma, bnr_intensity_threshold, yuvnr_idx, csupp_idx. h264_3dnr_lev， h264_3dnr_en
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 320lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 40lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 20lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 10lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 5p03lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 2p5lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 1p25lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 0p62lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 0p31lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 0p1lux
    {        0,                     0,           0,                     0,         0,         0,        0,      0},    // 0p01lux
};
const uint32 name_lsc_tbl[] = {
//R channel
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
//GR channel
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
//GB channel
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
//B channel
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,0x00040100,
};

const _Sensor_LSC          name_lsc_init = {
    .p_lsc_tbl = (uint32 *)name_lsc_tbl,
};

const _Sensor_LHS name_lhs_map[] = {
    // region defination: lower -> center -> upper(direction: anticlockwise)
    // region_lower, region_center, region_upper, hue adjust value, saturation adjust value
    //   (9 bits)      (9 bits)       (9 bits)          (9 bits)           (8 bits)
    {            24,            52,           80,                0,                       0},  // magenta,          range: 28
    {            80,           109,          138,                0,                       0},  // red,              range: 29
    {           140,           171,          202,               +0,                     +00},  // yellow,           range: 31
    {           204,           232,          260,              + 0,                       0},  // green,            range: 28
    {           261,           289,          317,                0,                       0},  // cyan,             range: 28
    {           320,           351,           22,                0,                       0},  // blue,             range: 31
    {           109,           132,          156,                0,                       0},  // skin enhance,     range:
    {           160,           203,          247,               +00,                      0},  // green enhance(plants),    range:
    {           296,           318,          340,                0,                       00}   // blue enhance,     range:
};

const _Sensor_YGAMMA name_ygamma_tbl[] = {
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
};

const _Sensor_WDR name_wdr_init = {
    .wdr_bv = { 0, 0, 0, 0, 0, 0, 0, 0},
    .max_ns_slope = { 0, 0, 0, 0, 0, 0, 0, 0},
    .max_shadow_slope = { 0, 0, 0, 0, 0, 0, 0, 0},
};
uint8 name_regValTable[25][6] = {
    // 00d1  00d0  0dc1  00b8  00b9  0155 
    {  0x00, 0x00, 0x00, 0x01, 0x00, 0x00},
    {  0x0A, 0x00, 0x00, 0x01, 0x0c, 0x00},
    {  0x00, 0x01, 0x00, 0x01, 0x1a, 0x00},
    {  0x0A, 0x01, 0x00, 0x01, 0x2a, 0x00},
    {  0x00, 0x02, 0x00, 0x02, 0x00, 0x00},
    {  0x0A, 0x02, 0x00, 0x02, 0x18, 0x00},
    {  0x00, 0x03, 0x00, 0x02, 0x33, 0x00},
    {  0x0A, 0x03, 0x00, 0x03, 0x14, 0x00},
    {  0x00, 0x04, 0x00, 0x04, 0x00, 0x02},
    {  0x0A, 0x04, 0x00, 0x04, 0x2f, 0x02},
    {  0x00, 0x05, 0x00, 0x05, 0x26, 0x02},
    {  0x0A, 0x05, 0x00, 0x06, 0x29, 0x02},
    {  0x00, 0x06, 0x00, 0x08, 0x00, 0x02},
    {  0x0A, 0x06, 0x00, 0x09, 0x1f, 0x04},
    {  0x12, 0x46, 0x00, 0x0b, 0x0d, 0x04},
    {  0x19, 0x66, 0x00, 0x0d, 0x12, 0x06},
    {  0x00, 0x04, 0x01, 0x10, 0x00, 0x06},				
    {  0x0A, 0x04, 0x01, 0x12, 0x3e, 0x08},
    {  0x00, 0x05, 0x01, 0x16, 0x1a, 0x0a},
    {  0x0A, 0x05, 0x01, 0x1a, 0x23, 0x0c},
    {  0x00, 0x06, 0x01, 0x20, 0x00, 0x0c},
    {  0x0A, 0x06, 0x01, 0x25, 0x3b, 0x0f},
    {  0x12, 0x46, 0x01, 0x2c, 0x33, 0x12},
    {  0x19, 0x66, 0x01, 0x35, 0x06, 0x14},
    {  0x20, 0x06, 0x01, 0x3f, 0x3f, 0x15},
};

uint32 name_gainLevelTable[26] = {
    64,  
    76,  
    90,  
    106, 
    128, 
    152, 
    
    179,
    212, 
    256, 
    303, 
    358, 
    425, 
    
    512, 
    607, 
    717, 
    849, 
        
    1024,
    1213,
    1434,
    1699,
    2048,			
    2427,
    2867,
    3398,
    4096,							
    0xffffffff,
};

void name_ae_adjust(struct isp_ae_func_cfg *p_cfg)
{
    uint32 i            = 0;
    uint32 index        = 0;
    uint32 total        = sizeof(name_gainLevelTable) / sizeof(uint32);
    uint32 tol_dig_gain = 0;
    uint32 gain         = p_cfg->analog_gain >> 2;
    uint8  *addr        = (uint8 *)p_cfg->data.addr;

    for(i = 0; i < total; i++)
    {
        if((name_gainLevelTable[i] <= gain)&&(gain < name_gainLevelTable[i+1]))
            break;
    }

    //tol_dig_gain = (gain)*64/name_gainLevelTable[i];
    tol_dig_gain = (p_cfg->analog_gain)*(64>>2)/name_gainLevelTable[i];

    if (p_cfg->chg_fps_flag) {
        addr[index++] = 0x0d;
        addr[index++] = 0x41;
        addr[index++] = p_cfg->frame_length >> 8;
        addr[index++] = 0x0d;
        addr[index++] = 0x42;
        addr[index++] = p_cfg->frame_length & 0xff;
    }
    addr[index++] = 0x00;
    addr[index++] = 0xd1;
    addr[index++] = name_regValTable[i][0];
    addr[index++] = 0x00;
    addr[index++] = 0xd0;
    addr[index++] = name_regValTable[i][1];
    addr[index++] = 0x03;
    addr[index++] = 0x1d;
    addr[index++] = 0x2e;
    addr[index++] = 0x0d;
    addr[index++] = 0xc1;
    addr[index++] = name_regValTable[i][2];
    addr[index++] = 0x03;
    addr[index++] = 0x1d;
    addr[index++] = 0x28;
    addr[index++] = 0x00;
    addr[index++] = 0xb8;
    addr[index++] = name_regValTable[i][3];
    addr[index++] = 0x00;
    addr[index++] = 0xb9;
    addr[index++] = name_regValTable[i][4];
    addr[index++] = 0x01;
    addr[index++] = 0x55;
    addr[index++] = name_regValTable[i][5];
    addr[index++] = 0x00;
    addr[index++] = 0xb1;
    addr[index++] = (uint8)(tol_dig_gain>>6);
    addr[index++] = 0x00;
    addr[index++] = 0xb2;
    addr[index++] = (uint8)((tol_dig_gain&0x3f)<<2);
    addr[index++] = 0x0d;
    addr[index++] = 0x03;
    addr[index++] = (uint8)(p_cfg->exposure_line >> 8);
    addr[index++] = 0x0d;
    addr[index++] = 0x04;
    addr[index++] = (p_cfg->exposure_line & 0xff);
    p_cfg->data.size = index;
    p_cfg->cmd_len   = 2+1;
}

const _Sensor_ISP_Init name_isp_init = 
{
    .type         = ISP_INPUT_DAT_SRC_MIPI0,
    .pixel_h      = 720,
    .pixel_w      = 1280,
    .bayer_patten = ISP_BAYER_FORMAT_GRBG,
    .input_format = ISP_INPUT_DAT_FORMAT_RAW10,
    .adjust_func  = (isp_ae_func     )name_ae_adjust,
    .p_blc        = (_Sensor_BLC    *)&name_blc_init,
    .p_ccm        = (_Sensor_CCM    *)&name_ccm_init,
	.p_dpc        = (_Sensor_DPC    *)&name_dpc_init,
	.p_csc        = (_Sensor_CSC    *)&name_csc_init,
	.p_gic        = (_Sensor_GIC    *)&name_gic_init,
    .p_awb        = (_Sensor_AWB    *)&name_awb_init,
    .p_ae         = (_Sensor_AE     *)&name_ae_init,
    .p_csupp      = (_Sensor_CSUPP  *)&name_csupp_init,
    .p_sharp      = (_Sensor_SHARP  *)&name_sharp_init,
    .p_yuvnr      = (_Sensor_YUVNR  *)&name_yuvnr_init,    
    .p_colenh     = (_Sensor_COLENH *)&name_colenh_init,	
    .p_bv2nr      = (_Sensor_BV2NR  *)name_bv2nr_init,
    .p_lsc        = (_Sensor_LSC    *)&name_lsc_init,
    .p_lhs        = (_Sensor_LHS    *)name_lhs_map,
    .p_ygamma     = (_Sensor_YGAMMA *)name_ygamma_tbl,
    .p_wdr        = (_Sensor_WDR    *)&name_wdr_init,
};


SENSOR_OP_SECTION const _Sensor_Adpt_ name_cmd = 
{
	.typ = 1, //YUV
	.pixelw = 1280,
	.pixelh= 720,
	.hsyn = 1,
	.vsyn = 1,
	.rduline = 0,//
	.rawwide = 1,//10bit
	.colrarray = 1,//0:_RGRG_ 1:_GRGR_,2:_BGBG_,3:_GBGB_
	.init = (uint8 *)nameInitTable,
    .init_len = sizeof(nameInitTable),
    .mipi_lane_num = 1,
	.rotate_adapt = {0},
	//.hvb_adapt = {0x6a,0x12,0x6a,0x12},
	. mclk = 24000000,
	.p_fun_adapt = {NULL,NULL,NULL},
    .sensor_isp = (_Sensor_ISP_Init *)&name_isp_init,
};

const _Sensor_Ident_ name_init =
{
	0x84, 0x6e, 0x6f, 0x02, 0x01, 0x03f1
};
#endif

